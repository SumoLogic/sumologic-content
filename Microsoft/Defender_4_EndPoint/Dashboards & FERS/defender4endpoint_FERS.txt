Defender for EndPoint FERs

Parsers needed to make Defender for EndPoint - Email Events Dashboard work:

| json "category" as category nodrop
| json "properties.RecipientEmailAddress" as recipientEmail nodrop
| json "properties.DeliveryAction" as emailDeliveryAction nodrop
| json "properties.EmailActionPolicy" as emailActionPolicy nodrop
| json "properties.DeliveryLocation" as deliveryLocation nodrop
| json "properties.DetectionMethods" as detectionMethods nodrop
| json field=detectionMethods "Phish[0]" as detection_methods nodrop
| json "properties.EmailDirection" as emailDirection nodrop
| json "properties.SenderFromAddress" as senderAddress nodrop
| json "properties.SenderDisplayName" as senderDisplayName nodrop
| json "properties.SenderMailFromDomain" as senderDomain nodrop
| json "properties.EmailAction" as action nodrop
| json "properties.ActionTrigger" as actionTrigger nodrop
| json "properties.ActionResult" as actionResult nodrop
| json "properties.ActionType" as actionType nodrop
| json "properties.ThreatTypes" as threatTypes nodrop
| replace(category, "AdvancedHunting-", "") as category


Other useful parsing statements:

| json "operationName" as operationName nodrop
| json "properties.DeviceName" as deviceName nodrop
| json "properties.DeviceId" as deviceID nodrop
| json "properties.ReportId" as reportID nodrop
| json "properties.Timestamp" as timestamp nodrop
| json "properties.RemoteIP" as remoteIP nodrop
| json "properties.RemotePort" as remotePort nodrop
| json "properties.LocatIP" as localIP nodrop
| json "properties.LocalPort" as localPort nodrop
| json "properties.Protocol" as protocol nodrop
| json "properties.RemoteUrl" as remoteURL nodrop
| json "properties.InitiatingProcessCreationTime" as creationTime nodrop
| json "properties.InitiatingProcessId" as processID nodrop
| json "properties.InitiatingProcessCommandLine" as commandLine nodrop
| json "properties.InitiatingProcessParentId" as parentID nodrop
| json "properties.InitiatingProcessParentFileName" as parentFileName nodrop
| json "properties.InitiatingProcessSHA1" as SHA1 nodrop
| json "properties.InitiatingProcessMD5" as MD5 nodrop
| json "properties.InitiatingProcessFolderPath" as folderPath nodrop
| json "properties.InitiatingProcessAccountName" as accountName nodrop
| json "properties.InitiatingProcessAccountDomain" as accountDomain nodrop
| json "properties.InitiatingProcessAccountSid" as accountSID nodrop
| json "properties.InitiatingProcessFileName" as fileName nodrop
| json "properties.InitiatingProcessIntegrityLevel" as integrityLevel nodrop
| json "properties.InitiatingProcessTokenElevation" as tokenElevation nodrop
| json "properties.AppGuardContainerId" as appGaurdContainerID nodrop
| json "properties.LocalIPType" as localIPType nodrop
| json "properties.InitiatingProcessSHA256" as SHA256 nodrop
| json "properties.InitiatingProcessAccountUpn" as accountUPN nodrop
| json "properties.InitiatingProcessAccountObjectId" as accountObjectID nodrop
| json "properties.AdditionalFields" as AdditionalFields nodrop
| json "properties.InitiatingProcessFileSize" as fileSize nodrop
| json "properties.InitiatingProcessVersionInfoCompanyName" as companyName nodrop
| json "properties.InitiatingProcessVersionInfoProductName" as productName nodrop
| json "properties.InitiatingProcessVersionInfoProductVersion" as productVersion nodrop
| json "properties.InitiatingProcessVersionInfoInternalFileName" as interalFileName nodrop
| json "properties.InitiatingProcessVersionInfoOrginalFileName" as orginalFileName nodrop
| json "properties.InitiatingProcessVersionInfoFileDescription" as fileDescription nodrop
| json "properties.MachineGroup" as machineGroup nodrop
| json "properties.RegistryKey" as registryKey nodrop
| json "properties.RegistryValueName" as registryValueName nodrop
| json "properties.RegistryValueType" as registryValueType nodrop
| json "properties.RegistryValueNameData" as registryValueData nodrop
| json "properties.RegistryValueData" as registryValueData nodrop
| json "properties.PreviousRegistryValueData" as previousRegistryValueData nodrop
| json "properties.PreviousRegistryValueName" as previousRegistryValueName nodrop
| json "properties.PreviousRegistryKey" as previousRegistryKey nodrop
| json "properties.NetworkMessageId" as networkMessageID nodrop
| json "properties.Url" as URL nodrop
| json "properties.UrlDomain" as URL_Domain nodrop
| json "properties.UrlLocation" as URL_Location nodrop
| json "properties.ApplicationId" as applicationID nodrop
| json "properties.AccountDisplayName" as displayName nodrop
| json "properties.AccountId" as accountID  nodrop
| json "properties.OSPlatfrorm" as OSPlatform nodrop
| json "properties.AccountObjectId" as accountObjectID nodrop
| json "properties.IPAddress" as ipAddress nodrop
| json "properties.IsAnonymousProxy" as isAnonymousProxy nodrop
| json "properties.Application" as application nodrop
| json "properties.City" as city nodrop
| json "properties.CountryCode" as countryCode nodrop
| json "properties.ISP" as ISP nodrop
| json "properties.SenderIPv4" as sender_ipAddress nodrop
| json "properties.Subject" as email_subject nodrop
| json "properties.EmailAction" as action nodrop
| json "properties.ConfidenceLevel" as confidenceLevel nodrop
| json "properties.AuthenticationDetails" as authenticationDetails nodrop
| json "properties.ThreatNames" as threatName nodrop
| json "properties.FileName" as fileName nodrop
| json "properties.FileType" as fileType nodrop
| json "properties.SHA256" as SHA256 nodrop
| json "properties.RecipientObjectId" as recipientObjectID nodrop
| json "properties.InternetMessageId" as internetMessageID nodrop
| json "properties.FileSize" as fileSize nodrop
| json field=confidenceLevel "Phish" as confidence_level nodrop