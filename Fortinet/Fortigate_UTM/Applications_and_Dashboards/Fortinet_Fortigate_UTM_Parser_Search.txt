_sourcecategory=fortigate !(%ASA) "type=utm"
| extract "date=(?<date>.*?) time=(?<time>.*?) devname=(?<devname>.*?) devid=(?<devid>.*?) logid=(?<logid>.*?) type=(?<type>.*?) subtype=(?<subtype>.*?) eventtype=(?<eventtype>.*?) level=(?<level>.*?) vd=[\"]*(?<vd>.*?)[\"]* " nodrop
| extract "sessionid=(?<sessionid>.*?) srcip=(?<srcip>.*?) srcport=(?<srcport>.*?) dstip=(?<dstip>.*?) dstport=(?<dstport>.*?) service=(?<service>.*?) profile=\"(?<profile>.*?)\" action=(?<action>.*?) reqtype=(?<reqtype>.*?) msg=\"(?<msg>.*?)\" sentbyte=(?<sentbyte>.*?) rcvdbyte=(?<rcvdbyte>.*?)" nodrop
| extract "sessionid=(?<sessionid>.*?) srcip=(?<srcip>.*?) srcport=(?<srcport>.*?) dstip=(?<dstip>.*?) dstport=(?<dstport>.*?) proto=(?<proto>.*?) service=(?<service>.*?) hostname=\"(?<hostname>.*?)\" profile=\"(?<profile>.*?)\" action=(?<action>.*?) reqtype=(?<reqtype>.*?) url=\"(?<url>.*?)\" sentbyte=(?<sentbyte>.*?) rcvdbyte=(?<rcvdbyte>.*?) direction=(?<direction>.*?) msg=\"(?<msg>.*?)\" method=(?<method>.*?) cat=(?<cat>.*?) catdesc=\"(?<catdesc>.*?)\"$" nodrop
| extract "appid=(?<appid>.*?) srcip=(?<srcip>.*?) srcport=(?<srcport>.*?) dstip=(?<dstip>.*?) dstport=(?<dstport>.*?) proto=(?<proto>.*?) service=(?<service>.*?) sessionid=(?<sessionid>.*?) applist=\"(?<applist>.*?)\" appcat=\"(?<appcat>.*?)\" app=\"(?<app>.*?)\" action=(?<action>.*?) (?:hostname=\"(?<hostname>.*?)\" url=\"(?<url>.*?)\" )?msg=\"(?<msg>.*?)\" apprisk=(?<apprisk>.*?)$" nodrop
//| count by sessionid,srcip,srcport,dstip,dstport,proto,service,hostname,profile,action,reqtype,url,sentbyte,rcvdbyte,direction,msg,method,cat,catdesc,appid,applist,appcat,app,apprisk